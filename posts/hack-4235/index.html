<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hack 4235 | Ben Fielding - Apprenticeship Portfolio</title>
<meta name="keywords" content="">
<meta name="description" content="Situation Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.
Task In order to standardize the configuration, utilize consul templates to configure application within the terraform-aws-jenkins module.
Action I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate.">
<meta name="author" content="">
<link rel="canonical" href="http://benfielding74.github.io/posts/hack-4235/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a8004b0d4af4113e0b10450304de95044c286fb2526cd887ce1059a6a0ddb0a5.css" integrity="sha256-qABLDUr0ET4LEEUDBN6VBEwob7JSbNiHzhBZpqDdsKU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://benfielding74.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://benfielding74.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://benfielding74.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://benfielding74.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://benfielding74.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Hack 4235" />
<meta property="og:description" content="Situation Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.
Task In order to standardize the configuration, utilize consul templates to configure application within the terraform-aws-jenkins module.
Action I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://benfielding74.github.io/posts/hack-4235/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-22T18:12:03&#43;01:00" />
<meta property="article:modified_time" content="2023-05-22T18:12:03&#43;01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hack 4235"/>
<meta name="twitter:description" content="Situation Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.
Task In order to standardize the configuration, utilize consul templates to configure application within the terraform-aws-jenkins module.
Action I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://benfielding74.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Hack 4235",
      "item": "http://benfielding74.github.io/posts/hack-4235/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hack 4235",
  "name": "Hack 4235",
  "description": "Situation Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.\nTask In order to standardize the configuration, utilize consul templates to configure application within the terraform-aws-jenkins module.\nAction I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate.",
  "keywords": [
    
  ],
  "articleBody": "Situation Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.\nTask In order to standardize the configuration, utilize consul templates to configure application within the terraform-aws-jenkins module.\nAction I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate. It is recommended for use when you are developing a new or improved design of a process, product or service, implementing any change, or starting a new improvement. As this was an iteration of our Jenkins stack that was designed to implement new security features and would require testing I felt this would be a good fit. (K6)\nThe Plan-Do-Check-Act technique:\nPlan - plan what needs to be done what is the core problem that needs to be solved? what resources do we have? what resources do we need? what is the best solution for fixing the problem? definition of done/what are the goals/what does success look like?\nDO - apply everything that has been considered during the previous stage -incorporate on a small scale in a controlled environment\nCheck - audit the plans execution see if it worked and monitor, analyze faults and problems\nAct - adopt if objectives met, may become standard baseline, make improvements\nI first had to do some research to understand how the current configuration works, how the files were structured, and decide how I would implement any possible solution.\nIn applying my plan (the Do stage) I updated the maven settings to be .ctmpl files instead of .xml files. I changed the references to credentials within the .xml files to reference instead a vault path and I updated the cloudinit_base.tmpl so that referenced the new file. I then added a new path in the Vault UI to hold the credentials. I then added a gradle.properties file holding the configuration for that.\n{{ with secret \"/secrets-infra/jenkins/generic/maven\" }}{{ .Data.data.security_password }}{{ end }} example of abstracting credentials to Vault\nI had to run my changes in a worker node within a test environment that we have to check if my changes were working. I ran into errors with the maven settings and new files that I had created. To identify the cause of some of these errors I had to ssh into the Jenkins instance and verify that /var/lib/jenkins/.m2 had the templates I had created in a rendered format. I could also check the status of Jenkins and query the startup logs. I debugged these errors one by one which mostly involved adjusting syntax and file paths for the changes I had made. Once I had everything working as it had been with the config in .xml I submitted a merge request and waited for a review by a senior.\nResult MR approved and merged and my changes rolled out to all environments. Ticket was beneficial to me as it started to give me an understanding of how Jenkins works and how we can utilize Vault to protect credentials within pipelines. Ticket benefitted the team and other feature teams using Jenkins as it enhanced security and the use of consul templates made the configuration easier to understand and amend.\n",
  "wordCount" : "545",
  "inLanguage": "en",
  "datePublished": "2023-05-22T18:12:03+01:00",
  "dateModified": "2023-05-22T18:12:03+01:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://benfielding74.github.io/posts/hack-4235/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ben Fielding - Apprenticeship Portfolio",
    "logo": {
      "@type": "ImageObject",
      "url": "http://benfielding74.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://benfielding74.github.io/" accesskey="h" title="Ben Fielding - Apprenticeship Portfolio (Alt + H)">Ben Fielding - Apprenticeship Portfolio</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://benfielding74.github.io/contents/" title="contents">
                    <span><i class='fa fa-heart'></i>contents</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Hack 4235
    </h1>
    <div class="post-meta"><span title='2023-05-22 18:12:03 +0100 BST'>May 22, 2023</span>&nbsp;|&nbsp;<a href="https://github.com/benfielding74/apprentice-portfolio/tree/main/content/posts/hack-4235/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
  <div class="post-content"><h4 id="situation">Situation<a hidden class="anchor" aria-hidden="true" href="#situation">#</a></h4>
<p>Configuration of Jenkins controller and agents is done by means of a Jenkins module which holds all of the Jenkins configuration in a mixture of xml and other files.</p>
<h4 id="task">Task<a hidden class="anchor" aria-hidden="true" href="#task">#</a></h4>
<p>In order to standardize the configuration, utilize consul templates to configure application within the <code>terraform-aws-jenkins</code> module.</p>
<h4 id="action">Action<a hidden class="anchor" aria-hidden="true" href="#action">#</a></h4>
<p>I decided to use the Plan-Do-Check-Act problem solving technique in my workflow for this ticket as I felt it would be most appropriate. It is recommended for use when you are developing a new or improved design of a process, product or service, implementing any change, or starting a new improvement. As this was an iteration of our Jenkins stack that was designed to implement new security features and would require testing I felt this would be a good fit. <a href="http://benfielding74.github.io/posts/work-mapping-table/#K6.1">(<em>K6</em>)</a></p>
<blockquote>
<p>The Plan-Do-Check-Act technique:</p>
<p>Plan - plan what needs to be done
what is the core problem that needs to be solved?
what resources do we have?
what resources do we need?
what is the best solution for fixing the problem?
definition of done/what are the goals/what does success look like?</p>
<p>DO - apply everything that has been considered during the previous stage -incorporate on a small scale in a controlled environment</p>
<p>Check - audit the plans execution see if it worked and monitor, analyze faults and problems</p>
<p>Act - adopt if objectives met, may become standard baseline, make improvements</p>
</blockquote>
<p>I first had to do some research to understand how the current configuration works, how the files were structured, and decide how I would implement any possible solution.</p>
<p>In applying my plan (the Do stage) I updated the maven settings to be .ctmpl files instead of .xml files. I changed the references to credentials within the .xml files to reference instead a vault path and I updated the cloudinit_base.tmpl so that referenced the new file. I then added a new path in the Vault UI to hold the credentials. I then added a gradle.properties file holding the configuration for that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;settingsSecurity&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;master&gt;</span>{{ with secret &#34;/secrets-infra/jenkins/generic/maven&#34; }}{{ .Data.data.security_password }}{{ end }}<span style="color:#f92672">&lt;/master&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/settingsSecurity&gt;</span>
</span></span></code></pre></div><p><em>example of abstracting credentials to Vault</em></p>
<p>I had to run my changes in a worker node within a test environment that we have to check if my changes were working. I ran into errors with the maven settings and new files that I had created. To identify the cause of some of these errors I had to ssh into the Jenkins instance and verify that /var/lib/jenkins/.m2 had the templates I had created in a rendered format. I could also check the status of Jenkins and query the startup logs. I debugged these errors one by one which mostly involved adjusting syntax and file paths for the changes I had made. Once I had everything working as it had been with the config in .xml I submitted a merge request and waited for a review by a senior.</p>
<h4 id="result">Result<a hidden class="anchor" aria-hidden="true" href="#result">#</a></h4>
<p>MR approved and merged and my changes rolled out to all environments. Ticket was beneficial to me as it started to give me an understanding of how Jenkins works and how we can utilize Vault to protect credentials within pipelines. Ticket benefitted the team and other feature teams using Jenkins as it enhanced security and the use of consul templates made the configuration easier to understand and amend.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="http://benfielding74.github.io/">Ben Fielding - Apprenticeship Portfolio</a></span>
    <span>Version 2.3.1</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>

</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
